<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="MBrasebin">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Exporter les résultats d'une simulation - SimPLU3D tutorial</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Exporter les r\u00e9sultats d'une simulation";
    var mkdocs_page_input_path = "export.md";
    var mkdocs_page_url = "/simplu3D-tutorial/export/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> SimPLU3D tutorial</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Accueil</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Premiers pas</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../begin/intro">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../begin/installation">Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../begin/first_simulation">Première simulation</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../principe/intro">Principe</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Environnement géographique</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../envgeo/intro">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../envgeo/modelgeo">Modèle géographique détaillé</a>
                </li>
                <li class="">
                    
    <a class="" href="../envgeo/integration">Processus d'intégration</a>
                </li>
                <li class="">
                    
    <a class="" href="../envgeo/integration-test">Tester l'intégration</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Générateur de formes</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../generator/intro">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../generator/principe">Principe de fonctionnement du générateur</a>
                </li>
                <li class="">
                    
    <a class="" href="../generator/custom-generator">Paramétrer la génération de cuboids</a>
                </li>
                <li class="">
                    
    <a class="" href="../custom-optimisation.md">Personnaliser la fonction d'optimisation</a>
                </li>
                <li class="">
                    
    <a class="" href="../generator/custom-shape">Personnaliser les formes utilisées</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Définition des contraintes morphologiques</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../rules/intro">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../rules/predicate/">Principe de fonctionnement du vérificateur</a>
                </li>
                <li class="">
                    
    <a class="" href="../rules/formats">Formats de règles</a>
                </li>
                <li class="">
                    
    <a class="" href="../rules/topologique">Définition de contraintes topologiques</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Exporter les résultats d'une simulation</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#export-general">Export général</a></li>
    

    <li class="toctree-l2"><a href="#export-de-boites">Export de boîtes</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#export-simple-des-boites">Export simple des boîtes</a></li>
        
            <li><a class="toctree-l3" href="#export-decoupe">Export découpé</a></li>
        
            <li><a class="toctree-l3" href="#export-fusionne">Export fusionné</a></li>
        
            <li><a class="toctree-l3" href="#synthese-des-exports">Synthèse des exports</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../visitor/intro">Suivre l'évolution d'une simulation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../openmole/intro">Distribuer avec OpenMole</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../development/">Futurs développements</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../about/">À propos</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bibliographie/">Réalisations et bibliographie</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">SimPLU3D tutorial</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Exporter les résultats d'une simulation</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/SimPLU3D/simplu3D-tutorial?query=root/path/docs/export.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="export-general">Export général<a class="headerlink" href="#export-general" title="Permanent link"></a></h1>
<p>Les objets produits par le simulateur sont stockés dans une instance de la classe  <em>GraphConfiguration</em>. Il est possible d'itérer sur les objets générés via le graphe associé. Le code ci-dessous montrer comment exporter sous forme d'un shapefile les résultats d'une simulation :</p>
<pre><code class="JAVA">// Run of the optimisation on a parcel with the predicate
GraphConfiguration&lt;Cuboid&gt; cc = oCB.process(bPU, p, env, 1, pred);

// Witting the output
IFeatureCollection&lt;IFeature&gt; iFeatC = new FT_FeatureCollection&lt;&gt;();
// For all generated boxes
for (GraphVertex&lt;Cuboid&gt; v : cc.getGraph().vertexSet()) {

  // Output feature with generated geometry
  IFeature feat = new DefaultFeature(v.getValue().generated3DGeom());


  iFeatC.add(feat);

}

ShapefileWriter.write(featC,&quot;tmp/result.shp&quot;);
</code></pre>

<h1 id="export-de-boites">Export de boîtes<a class="headerlink" href="#export-de-boites" title="Permanent link"></a></h1>
<p>Comme les boîtes sont les objets actuellement les plus utilisées comme sorties de SimPLU3D, différentes méthodes pour les exporter avec différentes transformations ont été implémentées dans le projet SimPLU3D.</p>
<p>Chacune des classes mentionnées ci-dessous possède un <em>main</em> permettant leur utilisation.</p>
<h2 id="export-simple-des-boites">Export simple des boîtes<a class="headerlink" href="#export-simple-des-boites" title="Permanent link"></a></h2>
<p>La classe <em>fr.ign.cogit.simplu3d.io.shapefile.SaveGeneratedObjects</em>  permet d'exporter les boîtes en shapefile (méthode saveShapefile) ou dans une base PostGIS (méthode save) sous forme de MultiPolygon 3D (issus de la méthode <em>generated3DGeom</em>). Dans les données en sortie, chaque ligne correspond à une boîte.</p>
<h2 id="export-decoupe">Export découpé<a class="headerlink" href="#export-decoupe" title="Permanent link"></a></h2>
<p>Comme les boîtes générées peuvent s'intersecter, ces intersections sont potentiellement des sources de problème pour calculer des indicateurs sur les formes résultantes ou pour les visualiser.</p>
<p>Ainsi, la classe <em>fr.ign.cogit.simplu3d.util.merge.SDPCalc</em> permet d'exporter avec la méthode <em>getGeometryPairByGroup</em> les boîtes sous la forme d'une partition des géométries résultats avec une hauteur affectée à chaque patch. Le résultat contient pour chaque enregistrement un polygone 2D et une hauteur pour regénérer la forme en 3D.</p>
<p>Cet export facilite le calcul de la surface de plancher et de la surface 2D de la construction (méthode <em>process</em> et méthode <em>processSurface</em>).</p>
<h2 id="export-fusionne">Export fusionné<a class="headerlink" href="#export-fusionne" title="Permanent link"></a></h2>
<p>La classe <em>fr.ign.cogit.simplu3d.util.merge.MergeCuboid</em> propose une fusion 3D des boîtes résultantes via la méthode <em>mergeFromShapefile</em>. Les faces intérieures sont supprimées et les boîtes générées en 3D. Ce cas est très utile pour la visualisation et le calcul de la surface extérieure avec la méthode <em>getSurface</em>.</p>
<p>L'attribut statique de cette classe <em>zMIN</em> permet de fixer l'altitude minimale au dessus de laquelle les boîtes seront extrudées.</p>
<h2 id="synthese-des-exports">Synthèse des exports<a class="headerlink" href="#synthese-des-exports" title="Permanent link"></a></h2>
<p><img alt="Illustration des différents export" src="../img/exportTypes.png" /></p>
<p>L'image ci-dessus illustre les différents types d'exports. Si de base la vue 3D est la même pour les trois résultats, les exports sont différents dans leur modélisation des entités et des géométries. La seconde partie de l'image montre dans une vue 2D la sélection d'une entité (en jaune) dans les trois types d'export :</p>
<ul>
<li><strong>Export simple</strong> : une entité = une boîte avec une hauteur. Il y a donc beaucoup d'intersections entre objets ;</li>
<li><strong>Export découpé</strong> :  une entité = une géométrie découpée par l'intersection des autres géométries. Chaque composante géométrique peut être extrudée ce qui donne un dédoublement des faces verticales à l'intersection entre deux géométries découpées ;</li>
<li><strong>Export fusionné</strong> : une entité = une forme bâtie, c'est à dire la fusion des géométries qui s'intersectent. Ici, le résultat est géométriquement propre, il n'y a pas de doublon au niveau des faces verticales.</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../development/" class="btn btn-neutral float-right" title="Futurs développements">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Accueil"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>IGNF 2018-2019</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/SimPLU3D/simplu3D-tutorial" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../development/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
